{% extends "base.html" %}

{% block title %}{{ t('لوحة تحكم المدير') }}{% endblock %}

{% block page_title %}{{ t('لوحة تحكم المدير') }}{% endblock %}
{% block page_subtitle %}{{ t('إدارة النظام والمستخدمين') }}{% endblock %}

{% block content %}
<!-- Statistics at Top -->
<div class="row mb-4">
    <div class="col-sm-6 col-lg-3">
        <div class="card card-sm">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <span class="bg-blue text-white avatar">
                            <i class="ti ti-users"></i>
                        </span>
                    </div>
                    <div class="col">
                        <div class="font-weight-medium" id="stat-users">-</div>
                        <div class="text-muted">{{ t('إجمالي المستخدمين') }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-6 col-lg-3">
        <div class="card card-sm">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <span class="bg-green text-white avatar">
                            <i class="ti ti-user-check"></i>
                        </span>
                    </div>
                    <div class="col">
                        <div class="font-weight-medium" id="stat-admins">-</div>
                        <div class="text-muted">{{ t('المدراء') }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-6 col-lg-3">
        <div class="card card-sm">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <span class="bg-purple text-white avatar">
                            <i class="ti ti-robot"></i>
                        </span>
                    </div>
                    <div class="col">
                        <div class="font-weight-medium" id="stat-types">-</div>
                        <div class="text-muted">{{ t('أنواع المساعدين') }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-6 col-lg-3">
        <div class="card card-sm">
            <div class="card-body">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <span class="bg-orange text-white avatar">
                            <i class="ti ti-language"></i>
                        </span>
                    </div>
                    <div class="col">
                        <div class="font-weight-medium" id="stat-languages">-</div>
                        <div class="text-muted">{{ t('اللغات') }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Links List -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">{{ t('إدارة النظام') }}</h3>
            </div>
            <div class="list-group list-group-flush">
                <a href="/admin/users" class="list-group-item list-group-item-action d-flex align-items-center">
                    <span class="badge bg-blue me-3"><i class="ti ti-users"></i></span>
                    <div>
                        <div class="font-weight-medium">{{ t('إدارة المستخدمين') }}</div>
                        <div class="text-muted small">{{ t('إضافة وتعديل وحذف المستخدمين') }}</div>
                    </div>
                    <i class="ti ti-chevron-left ms-auto"></i>
                </a>
                <a href="/admin/assistant-types" class="list-group-item list-group-item-action d-flex align-items-center">
                    <span class="badge bg-purple me-3"><i class="ti ti-robot"></i></span>
                    <div>
                        <div class="font-weight-medium">{{ t('أنواع المساعدين') }}</div>
                        <div class="text-muted small">{{ t('إدارة أنواع المساعدين المتاحة') }}</div>
                    </div>
                    <i class="ti ti-chevron-left ms-auto"></i>
                </a>
                <a href="/admin/notify-templates" class="list-group-item list-group-item-action d-flex align-items-center">
                    <span class="badge bg-teal me-3"><i class="ti ti-template"></i></span>
                    <div>
                        <div class="font-weight-medium">{{ t('قوالب الإشعارات') }}</div>
                        <div class="text-muted small">{{ t('إدارة قوالب رسائل الإشعارات') }}</div>
                    </div>
                    <i class="ti ti-chevron-left ms-auto"></i>
                </a>
                <a href="/translations" class="list-group-item list-group-item-action d-flex align-items-center">
                    <span class="badge bg-orange me-3"><i class="ti ti-language"></i></span>
                    <div>
                        <div class="font-weight-medium">{{ t('إدارة الترجمات') }}</div>
                        <div class="text-muted small">{{ t('ترجمة النظام للغات المختلفة') }}</div>
                    </div>
                    <i class="ti ti-chevron-left ms-auto"></i>
                </a>
                <a href="/admin/email-settings" class="list-group-item list-group-item-action d-flex align-items-center">
                    <span class="badge bg-cyan me-3"><i class="ti ti-mail"></i></span>
                    <div>
                        <div class="font-weight-medium">{{ t('إعدادات البريد') }}</div>
                        <div class="text-muted small">{{ t('تكوين إعدادات البريد الإلكتروني') }}</div>
                    </div>
                    <i class="ti ti-chevron-left ms-auto"></i>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block page_js %}
<script>
document.addEventListener('DOMContentLoaded', loadStats);

function loadStats() {
    Promise.all([
        fetch('/admin/api/users').then(r => r.json()),
        fetch('/admin/api/assistant-types').then(r => r.json()),
        fetch('/api/languages').then(r => r.json())
    ]).then(([users, types, languages]) => {
        document.getElementById('stat-users').textContent = users.length;
        document.getElementById('stat-admins').textContent = users.filter(u => u.is_admin).length;
        document.getElementById('stat-types').textContent = types.length;
        document.getElementById('stat-languages').textContent = languages.length;
    });
}
</script>
{% endblock %}
